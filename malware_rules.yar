rule backdoor_trojan {
    meta:
        description = "Detects a simple backdoor Trojan"
        author = "Emin Unal"
        date = "2023-03-15"
        hash1 = "5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8"
        hash2 = "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
        hash3 = "8754c2a98e3b9c86aa49d4a35b8835e5fc6d5e6f53d6bce44a7f8db9c524de7a"

    strings:
        $a = { 50 61 72 73 65 20 62 6c 61 63 6b 20 54 72 6f 6e 65 }  // "Password Trojan"
        $b = { 4d 65 64 69 61 20 53 74 72 69 6e 67 20 4d 65 73 73 61 67 65 }  // "Medium Software Agreement"
        $c = { 68 61 73 73 65 20 73 74 72 69 6e 67 20 69 73 20 6e 6f 74 20 68 61 73 73 65 }  // "Hash software is a hash"

    condition:
        (uint16(0) == 0x5a4d) and (uint32(uint32(0x3c)) == 0x00004550) and
        (uint32(uint32(0x38)) == 0x00000100) and (uint32(0x78) == 0x00000000) and
        (uint32(0x7c) == 0x00000000) and (uint32(0x80) == 0x00000000) and
        (uint32(0x84) == 0x00000000) and (uint32(0x88) == 0x00000000) and
        (uint32(0x8c) == 0x00000000) and (uint32(0x90) == 0x00000000) and
        (uint32(0x94) == 0x00000000) and (uint32(0x98) == 0x00000000) and
        (uint32(0x9c) == 0x00000000) and (uint32(0xa0) == 0x00000000) and
        (uint32(0xa4) == 0x00000000) and (uint32(0xa8) == 0x00000000) and
        (uint32(0xac) == 0x00000000) and (uint32(0xb0) == 0x00000000) and
        (uint32(0xb4) == 0x00000000) and (uint32(0xb8) == 0x00000000) and
        ($a or $b or $c)
}